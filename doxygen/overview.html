<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>ESTER: Overview</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">ESTER
   </div>
   <div id="projectbrief">Evolution STEllaire en Rotation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Overview </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>ESTER uses Newton's method to solve the set of stellar PDEs.</p>
<p>Solving the PDE \( L(u) = 0 \tag{1} \) with Newton's method is done by refining the solution (last iterate) \( u_n\), by first solving:</p>
<p>\( J_L(\delta u) = -L(u_n) \tag{2} \) for \(\delta u\) and then updating the solution with \( u = u_n + \delta u \)</p>
<p>In order to write equations in a simple way, the ESTER code uses a specific formalism, which can be easily understood with an example.</p>
<p>Let us take Poisson equation :</p>
<p>\( \Delta \phi = \pi_c \rho, \qquad {\rm with}\quad \pi_c = \frac{4 \pi G \rho_c^2 R^2}{p_c} \tag{3}\)</p>
<p>The evaluation of the Newton increment demands the solution of : \( \Delta \delta\phi - \rho\delta\pi_c - \pi_c\delta\rho = -(\Delta \phi - \pi_c \rho)_n \tag{4}\)</p>
<p>This is equivalent to the code: </p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;lap_phi=lap(phi);    </div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;lap_phi.add(op, <span class="stringliteral">&quot;eq_Phi&quot;</span>, <span class="stringliteral">&quot;Phi&quot;</span>);</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;lap_phi.add(op, <span class="stringliteral">&quot;eq_Phi&quot;</span>, <span class="stringliteral">&quot;</span><span class="stringliteral">r&quot;);</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="stringliteral">op-&gt;add_d(</span><span class="stringliteral">&quot;eq_Phi&quot;</span>, <span class="stringliteral">&quot;rho&quot;</span>, -pi_c*ones(nr, nth));</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;op-&gt;add_d(<span class="stringliteral">&quot;eq_Phi&quot;</span>, <span class="stringliteral">&quot;pi_c&quot;</span>, -rho);</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;rhs1 = -lap_phi.eval()+pi_c*rho;</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;rhs2=-lap_phi.eval();</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;rhs=zeros(nr+nex,nth);</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;rhs.setblock(0,nr-1,0,-1,rhs1);</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;rhs.setblock(nr,nr+nex-1,0,-1,rhs2);</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;op-&gt;set_rhs(<span class="stringliteral">&quot;eq_Phi&quot;</span>,rhs);</div>
</div><!-- fragment --><p> Line 1 defines the symbolic expression for \( \Delta \phi \) (see <a class="el" href="classsymbolic.html">symbolic</a>).</p>
<p>Line 2 says that the equation associated with lap_phi is tagged "eq_Phi" and that it depends on the variable \(\phi\).</p>
<p>Line 3 says that equation "eq_Phi" also depends on \( r \).</p>
<p>Lines 5 and 6 add the remaining terms to the Jacobian matrix. We see the coefficient \( -\pi_c \) of \(\delta\rho \) and \(-\rho\) of \(\delta\pi_c\). This completes the definition of the left-hand side of the equation.</p>
<p>Line 8 prepares the RHS of the equation for the domains within the star.</p>
<p>Line 9 prepares the RHS of the equation for the domain outside the star.</p>
<p>Line 11 initializes the RHS-matrix</p>
<p>line 12 inserts rhs1 into the block describing radial points from 0 to nr-1, and for all latitudinal points "0,-1" (-1 is C++ coding for the last point).</p>
<p>Line 13 inserts rhs2 into the block for the outer (vacuum) domain.</p>
<p>Line 15 inserts the RHS into equation "eq_Phi"</p>
<h1><a class="anchor" id="var_sec"></a>
Variables in ESTER</h1>
<table class="doxtable">
<tr>
<th>Variable </th><th>Name in the code </th><th>Description  </th></tr>
<tr>
<td>\( \phi \) </td><td>Phi </td><td>gravitational potential </td></tr>
<tr>
<td>\( p \) </td><td>p </td><td>pressure </td></tr>
<tr>
<td>\( \log p \) </td><td>log_p </td><td>log of the pressure </td></tr>
<tr>
<td>\( \pi_c \) </td><td></td><td>\(\frac{4\pi G \rho^2_c R^2}{p_c}\) </td></tr>
<tr>
<td>\( T \) </td><td>T </td><td>temperature </td></tr>
<tr>
<td>\( \log T \) </td><td>log_T </td><td>log of the temperature </td></tr>
<tr>
<td>\( \Lambda \) </td><td>Lambda </td><td>\( \frac{\rho_c R^2}{T_c} \) </td></tr>
<tr>
<td>\( \eta \) </td><td>eta </td><td>array of the polar radii of the domains </td></tr>
<tr>
<td>\( \Delta\eta \) </td><td>deta </td><td>array deta(i)=eta(i+1)-eta(i) </td></tr>
<tr>
<td>\( R_i \) </td><td>Ri </td><td>array \(R_i(\theta_k)\) </td></tr>
<tr>
<td>\( \Delta R_i \) </td><td>dRi </td><td>array \(R_{i+1}(\theta_k)-R_i(\theta_k)\) </td></tr>
<tr>
<td>\( r \) </td><td>r </td><td>radial distance (spherical coordinate) </td></tr>
<tr>
<td>\( r_\zeta \) </td><td>rz </td><td>\( \frac{\partial r}{\partial \zeta} \) </td></tr>
<tr>
<td>\( \gamma \) </td><td>gamma </td><td>metric element \(\sqrt{1+r^2_\theta/r^2}\) </td></tr>
<tr>
<td>\( \Omega \) </td><td>Omega </td><td>angular velocity (equator) </td></tr>
<tr>
<td>\( \log\rho_c \) </td><td>log_rhoc </td><td>log of central density </td></tr>
<tr>
<td>\( \log p_c \) </td><td>log_pc </td><td>log of central pressure </td></tr>
<tr>
<td>\( \log T_c \) </td><td>log_Tc </td><td>log of central temperature </td></tr>
<tr>
<td>\( \log R \) </td><td>log_R </td><td>log of polar radius </td></tr>
<tr>
<td>\( m \) </td><td>m </td><td>mass </td></tr>
<tr>
<td>\( p_s \) </td><td>ps </td><td>polar pressure </td></tr>
<tr>
<td>\( T_s \) </td><td>Ts </td><td>polar temperature </td></tr>
<tr>
<td>\( lum \) </td><td>lum </td><td>luminosity </td></tr>
<tr>
<td>\( Frad \) </td><td>Frad </td><td>normal radiative flux \(\mathbf{E}^\zeta\cdot\mathbf{F}_{\rm rad}\) (not normalized) </td></tr>
<tr>
<td>\( T_{eff} \) </td><td>Teff </td><td>effective temperature at star's surface </td></tr>
<tr>
<td>\( g_{sup} \) </td><td>gsup </td><td>gravity at star's surface </td></tr>
<tr>
<td>\( \omega \) </td><td>w </td><td>angular velocity </td></tr>
<tr>
<td>\( \Psi \) </td><td>G </td><td>stream function (meridional circulation) </td></tr>
<tr>
<td>\( \rho \) </td><td>rho </td><td>density </td></tr>
<tr>
<td>\( \xi \) </td><td>opa.xi </td><td>radial conductivity </td></tr>
<tr>
<td>\( \kappa \) </td><td>opa.k </td><td>opacity </td></tr>
<tr>
<td>\( \epsilon \) </td><td>nuc.eps </td><td>nuclear power </td></tr>
<tr>
<td>\( s \) </td><td>s </td><td>entropy </td></tr>
<tr>
<td>\( \mu \) </td><td>mu </td><td>dynamic shear viscosity </td></tr>
</table>
<h1><a class="anchor" id="eqlist_sec"></a>
Equations solved by ESTER</h1>
<table class="doxtable">
<tr>
<th>Equation </th><th>Name  </th></tr>
<tr>
<td>\( \Delta \phi - \pi_c \rho = 0 \) </td><td>Poisson - for the gravitational potential </td></tr>
<tr>
<td>\( \nabla p + \rho \nabla \phi - \rho s \Omega^2 \hat{s} = 0 \) </td><td>momentum (steady and inviscid) - for the pressure </td></tr>
<tr>
<td>\( \hat{\varphi} \cdot \frac{\nabla P\times\nabla\rho}{\rho^2} - s\frac{\partial \Omega^2}{\partial z} = 0 \) </td><td>vorticity - for the differential rotation \(\Omega(r,\theta)\) </td></tr>
<tr>
<td>\( \nabla\cdot (\rho s^2 \Omega \mathbf{V})-\nabla\cdot (\mu s^2\nabla \Omega) = 0 \) </td><td>transport of angular momentum - for the meridional circulation </td></tr>
<tr>
<td>\( -\frac{\nabla\cdot (\xi \nabla T))}{\xi} + \frac{\Lambda \rho \epsilon}{\xi}= 0 \) </td><td>Heat - for the temperature </td></tr>
</table>
<p>Where:</p>
<ul>
<li>\( s = r \sin\theta \)</li>
<li>\( \hat{s} = \nabla s\)</li>
<li>\( \hat{\varphi}\) is the azimuthal unit vector</li>
<li>\( \mathbf{V} = \frac{\nabla\times (\Psi \hat{\varphi})}{\rho} \) is the meridional velocity</li>
</ul>
<h1><a class="anchor" id="algo_sec"></a>
Code Overview</h1>
<p>The Newton iteration is performed in <a class="el" href="classstar2d.html#a478e9e40c696a8d4cfe1e28353d3ea69" title="Performs one step of the Newton algorithm to compute the star&#39;s internal structure. ">star2d::solve</a>. The set of equation and boundary conditions are written in the solver in functions:</p>
<ul>
<li><a class="el" href="classstar2d.html#a99d83e13764a03c45df37ccea0940366" title="Writes terms depending opacity and state tables into the solver. ">star2d::solve_definitions</a></li>
<li><a class="el" href="classstar2d.html#ad5842ec4740386fb49d82f1d74581724" title="Writes Poisson equation and interface conditions into the solver. ">star2d::solve_poisson</a></li>
<li><a class="el" href="classstar2d.html#a744a12b8bd2aa2e9672b8e1588f319b4" title="Writes movement and vorticity equations into the solver. ">star2d::solve_mov</a></li>
<li><a class="el" href="classstar2d.html#a1af2f9bcd3eb35edd3029001ba1176aa" title="Writes temperature and luminosity equations and interface conditions into the solver. ">star2d::solve_temp</a></li>
<li>star2d::solve_dim</li>
<li>star2d::solve_map</li>
<li>star2d::solve_Omega</li>
<li>star2d::solve_atm</li>
<li>star2d::solve_gsup</li>
<li>star2d::solve_Teff</li>
</ul>
<p>Function <a class="el" href="classsolver.html#ad26b8574d24d480e4434dc3cc2810ce3" title="Solves the set of equations stored in the operator object. ">solver::solve</a> stores all the terms registered in the operator in the previous steps into the operator matrix (see <a class="el" href="classsolver.html#a8f4ec1fefcb8517f070543be1bc7768c" title="Stores distributed (ie. split into several blocks) matrix y into the single vector x...">solver::wrap</a>, <a class="el" href="classsolver.html#ab75fb52ae803c4721c08dc8f55bfd200" title="Performs the inverse operation of the wrap function: restore the single vector x into the blocked vec...">solver::unwrap</a> and <a class="el" href="classsolver.html#a56b249056bea1e6f7dcd8f1166246a26" title="Creates the solver solver operator depending on the type of solver configured (defined when calling s...">solver::create</a>). And then solves the matrix and update the solution the solution fields. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Jun 9 2015 11:48:11 for ESTER by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
